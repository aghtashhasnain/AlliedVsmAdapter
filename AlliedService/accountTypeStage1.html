<link rel="stylesheet" href="./CSS/steps/fonts/material-icon/css/material-design-iconic-font.min.css">
<link rel="stylesheet" href="./CSS/steps/css/style.css">
<link rel="Stylesheet" href="./CSS/jquery-ui.css" />
<link rel="stylesheet" href="./Scripts/bootstrap-3.4.1-dist/css/bootstrap.min.css" />
<link rel="stylesheet" href="./css/keyboard/keyboard.css" />
<link rel="stylesheet" href="./css/keyboard/keyboard-previewkeyset.css" />
<link rel="stylesheet" href="./css/FlatePiker.css">

<!-- <link href="./css/DateRange/bootstrap-material-datetimepicker.css" rel="stylesheet" />
<link href="./css/DateRange/fontawesome.css" rel="stylesheet" /> -->




<style type="text/css">
  

    .form-control {

        height: 47px !important;
    }

    .MainHeader {
        font-size: 22px;
        font-weight: 600;
        color: #333;
        margin: 0px 0px 30px 2px;
        text-align: start;
        display: flex
    }

    .hidden {
        display: none;
    }


    .MainHeader:before {
        content: "";
        position: absolute;
        height: 4px;
        width: 166px;
        border-radius: 8px;
        background-color: #2E3192;
        margin-top: 29px;
    }

    .arrow-Right {
        height: 16px;
        width: 16px;
        border: 6px solid #2E3192;
        border-width: 4px 4px 0 0;
        transform: rotate(45deg);
        margin-left: 2px;
        margin-top: 5px;
    }

    .arrow-Right:after {

        content: '';
        display: block;
        height: 16px;
        width: 16px;
        border: 6px solid #2E3192;
        border-width: 4px 4px 0 0;
        transform: translate(7px, -11px);
    }




    .tab-menu {
        color: white;
    }

    .nav-tabs>li.active>a,
    .nav-tabs>li.active>a:focus,
    .nav-tabs>li.active>a:hover {
        color: white !important;
        cursor: default;
        background-color: #000;
        border: 1px solid #ddd;
        border-bottom-color: transparent;
    }

    .H_oncheck {
        display: none;
    }

    .form-group,
    .form-group input {
        text-align: left !important;
    }

    .btn-save-exit {
        width: 180px;
        position: absolute;
        left: 56px;
        top: 0;
        height: 40px;
        background: #333;
        border-radius: 5px;
        text-align: center;
        /*! vertical-align: middle; */
        padding: 7px 0;
        /*background-image: linear-gradient(to right top, #004e59, #00515c, #00545f, #005862, #005b65, #005d67, #00606a, #00626c, #00646e, #006671, #006873, #2E3192);*/
        background: #2E3192;
        color: white !important;
    }

    .btn-save-exit:hover,
    .btn-save-exit:active,
    .btn-save-exit:focus {
        color: white !important;
        text-decoration: none;
    }

    .btn-next-activity {
        width: 120px;
        position: absolute;
        left: 765px;
        top: 0;
        height: 40px;
        background: #333;
        border-radius: 5px;
        text-align: center;
        padding: 7px 0;
        /*background-image: linear-gradient(to right top, #004e59, #00515c, #00545f, #005862, #005b65, #005d67, #00606a, #00626c, #00646e, #006671, #006873, #2E3192);*/
        background: #2E3192;
        color: white !important;
    }

    .btn-next-activity:hover,
    .btn-next-activity:active,
    .btn-next-activity:focus {
        color: white !important;
        text-decoration: none;
    }

    .btn-previous-activity {
        width: 120px;
        position: absolute;
        left: 634px;
        top: 0;
        height: 40px;
        background: #333;
        border-radius: 5px;
        text-align: center;
        padding: 7px 0;
        /*background-image: linear-gradient(to right top, #004e59, #00515c, #00545f, #005862, #005b65, #005d67, #00606a, #00626c, #00646e, #006671, #006873, #2E3192);*/
        background: #2E3192;
        color: white !important;
    }

    .btn-previous-activity:hover,
    .btn-previous-activity:active,
    .btn-previous-activity:focus {
        color: white !important;
        text-decoration: none;
    }

    /* Hide Steps buttons */
    /*.actions.clearfix ul li a {
        visibility: hidden;
    }*/

    #main-container-p-0 {
        margin-top: 15px;
    }

    .col-md-2 {
        width: 20%;
    }

    label.error {
        color: red;
        font-weight: normal;
    }
</style>



<style type="text/css">
    .steps-content {
        width: 100%;
        height: 740px;
    }


    .container,
    .container form {
        width: 100%;
    }

    .container {
        padding: 0;
    }

    .steps ul::after {
        width: 98%;
        bottom: 18px;
    }

    .steps ul .current .title-number {
        /*background-image: linear-gradient(to right top, #004e59, #00515c, #00545f, #005862, #005b65, #005d67, #00606a, #00626c, #00646e, #006671, #006873, #2E3192);*/
        background: #2E3192;
    }

    body {
        /*background-image: linear-gradient(to right top, #004e59, #00515c, #00545f, #005862, #005b65, #005d67, #00606a, #00626c, #00646e, #006671, #006873, #2E3192);*/
        background: #2E3192;
    }

    .actions ul li a {
        /*background-image: linear-gradient(to right top, #004e59, #00515c, #00545f, #005862, #005b65, #005d67, #00606a, #00626c, #00646e, #006671, #006873, #2E3192);*/
        background: #2E3192;
    }

    .main {
        padding-top: 50px;
    }

    .steps ul .disabled {
        opacity: 1;
    }

    .title-text {
        font-size: 15px;
    }

    .scroll-section {
        overflow-y: auto !important;
        height: 664px !important;
        scrollbar-color: #2E3192 #7375b7 !important;
        background: #ffffff;
        padding: 0px 58px;
        border-radius: 15px;
        margin: 0px;
    }

    .scroll-section::-webkit-scrollbar {
        /*display: none;*/
        width: 15px;
    }

    .scroll-section::-webkit-scrollbar-track-piece {
        background-color: #D3D3D3;
    }

    .scroll-section::-webkit-scrollbar-thumb:vertical {
        background-color: #2E3192;
    }

    .scroll-section .row {

        margin-right: 0;
        margin-top: 10px;
    }

    select {
        scrollbar-width: thin;

    }

    .ui-state-hover,
    .ui-widget-content .ui-state-hover,
    .ui-widget-header .ui-state-hover,
    .ui-state-focus,
    .ui-widget-content .ui-state-focus,
    .ui-widget-header .ui-state-focus {
        border: 2px solid #2E3192 !important;
        background: white !important;
        color: #2E3192;
    }

    .ui-state-default,
    .ui-widget-content .ui-state-default,
    .ui-widget-header .ui-state-default {
        background: #2E3192;
        border: 1px solid #2E3192;
        border-radius: 5px;

    }

    .ui-state-active,
    .ui-widget-content .ui-state-active,
    .ui-widget-header .ui-state-active {
        background: black;
        border: none;
    }

    #permanent_country[disabled] {
        background-color: #eee !important;
    }
</style>




<style>
    .marquee {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 30px;
        background-color: black;
    }

    .marquee p {
        position: absolute;
        width: 100%;
        height: 100%;
        margin: 0;
        line-height: 30px;
        text-align: center;
        color: white;
        font-size: 18px;
        -moz-transform: translateX(100%);
        -webkit-transform: translateX(100%);
        transform: translateX(100%);
        -moz-animation: scroll-left 2s linear infinite;
        -webkit-animation: scroll-left 2s linear infinite;
        animation: scroll-left 30s linear infinite;
    }

    @-moz-keyframes scroll-left {
        0% {
            -moz-transform: translateX(100%);
        }

        100% {
            -moz-transform: translateX(-100%);
        }
    }

    @-webkit-keyframes scroll-left {
        0% {
            -webkit-transform: translateX(100%);
        }

        100% {
            -webkit-transform: translateX(-100%);
        }
    }

    @keyframes scroll-left {
        0% {
            -moz-transform: translateX(100%);
            -webkit-transform: translateX(100%);
            transform: translateX(100%);
        }

        100% {
            -moz-transform: translateX(-100%);
            -webkit-transform: translateX(-100%);
            transform: translateX(-100%);
        }
    }
</style>
<div class="LoaderImg" id="preloader12">
    <div class="InnerLoader">
        <div class="spinner-2">
        </div>
        <img src="images/LoaderLogo.png" alt="">
    </div>

</div>
<div class="modalExit">
    <div class="modal-content">
       
        <div class="Modalbody">
            <img src="./images/Exit.png" alt="">
            <h1>Do You Want to Exit ?</h1>
        </div>
        <div class="Modalfooter">
            <button class="Cancel">Cancel</button>
            <button class="Exit" onclick="NextForm(1)">Exit</button>
        </div>
    </div>

</div>
<div class="row" style="position: absolute;top: 26px;left: 42px;">
    <div class="col-md-12">
        <img class="pull-left" src="./images/Logo.png" style="width: 209px;filter: brightness(0) invert(1);" />
    </div>
</div>
<section style="width:100%;position:relative;" id="form-section">
    <div class="main">
        <div class="container">
            <div id="main-container" style="position:relative;width:100%;">
                <!--<form method="POST" id="signup-form" class="signup-form" enctype="multipart/form-data">-->
                <h3 style="position: absolute; color: white;left: 44px;">
                    Account Types
                </h3>
                <fieldset>
                    <form id="form-0">
                        <div class="scroll-section auto-scroll">
                            <h2 class="MainHeader">
                                Account Types

                            </h2>
                            <div class="InputProgressBlock">
                                <div class="InputpercantageText">
                                    <p id="percentageText">0</p>
                                    <span class="ml-1"> / 100</span>
                                </div>

                                <div class="Inputprogress-bar">
                                    <div class="Inputprogress" id="Inputprogress"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">

                                    <div class="form-group">
                                        <label class="FormLabel">Account Type<span style="color:red;">*</span></label>
                                        <select name="category" class="FormInput" id="category" data-val="true"
                                            data-val-required="This field is required" onchange="updateProgress()">
                                            <option value="" disabled selected>--- Select Account Type ---</option>
                                            <option value="1001">Current Account</option>
                                            <option value="6001">Savings Account Ordinary</option>
                                            <option value="6005">Savings Account Student Save</option>
                                        </select>

                                        <span data-valmsg-for="category" data-valmsg-replace="true" class=""></span>
                                    </div>



                                    <div class="form-group">
                                        <label class="FormLabel">Middle Name</label>


                                        <input type="text" id="middleName" name="middleName" value=""
                                            class="FormInput inputRef" placeholder="Enter Your Middle Name"
                                            data-val="true"
                                            data-val-regex="Please enter valid name. Only alphabets are allowed"
                                            data-val-regex-pattern="^[A-Z a-z]{1,35}$" onchange="updateProgress()">
                                        <span data-valmsg-for="middleName" data-valmsg-replace="true" class=""></span>
                                    </div>

                                    <div class="form-group">
                                        <label class="FormLabel">ID Type<span style="color:red;">*</span></label>


                                        <select id="idType" name="idType" class="FormInput" data-val="true"
                                            data-val-required="This field is required"
                                            onchange="updateIssuingAuthority(); updateProgress();">
                                            <option value="" selected disabled> --- Select ID Type ---</option>
                                            <option value="NATIONAL.ID">National ID</option>
                                            <option value="DRIVING.LICENSE">Driving License</option>
                                            <option value="PASSPORT">Passport</option>
                                            <option value="ROAD.TRAF.REG.CARD">Road Traffic Register Card
                                            </option>
                                            <option value="STUDENT.ID">Student ID</option>
                                        </select>
                                        <span data-valmsg-for="idType" data-valmsg-replace="true" class=""></span>
                                    </div>
                                    <div class="form-group">

                                        <label class="FormLabel">Issuing Authority</label>

                                        <input type="text" id="issuingAuthorityText" name="issuingAuthorityText"
                                            class="FormInput inputRef hidden" placeholder="Enter Issuing Authority"
                                            data-val="true" data-val-required="This field is required"
                                            data-val-regex="Please enter valid name. Only alphabets are allowed"
                                            data-val-regex-pattern="^[A-Z a-z]{1,35}$" onchange="updateProgress()">
                                        <select id="issuingAuthority" name="issuingAuthority" class="FormInput"
                                            data-val-required="This field is required">
                                            <option value="" selected disabled>--- Select Issuing Authority ---
                                            </option>
                                        </select>
                                        <span data-valmsg-for="issuingAuthorityText" data-valmsg-replace="true"
                                            class=""></span>
                                    </div>


                                    <div class="form-group">
                                        <label class="FormLabel">Issue Date<span style="color:red;">*</span></label>
                                        <input type="date" name="issueDate" class="FormInput" id="issueDate"
                                            placeholder="Enter ID Issue Date" data-val="true"
                                            data-val-required="This field is required" onchange="updateProgress()">
                                        <span data-valmsg-for="issueDate" data-valmsg-replace="true"
                                            id="issueDate_error" class="" ></span>
                                    </div>

                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">

                                        <label class="FormLabel">First Name<span style="color:red;">*</span></label>


                                        <input type="text" id="firstName" name="firstName" class="FormInput inputRef"
                                            placeholder="Enter Your First Name" data-val="true"
                                            data-val-required="This field is required"
                                            data-val-regex="Please enter valid name. Only alphabets are allowed"
                                            data-val-regex-pattern="^[A-Z a-z]{1,35}$" onchange="updateProgress()">
                                        <span class="" data-valmsg-for="firstName" data-valmsg-replace="true"></span>
                                    </div>
                                    <div class="form-group">
                                        <label class="FormLabel">Last Name<span style="color:red;">*</span></label>
                                        <input type="text" id="lastName" name="lastName" class="FormInput inputRef"
                                            placeholder="Enter Your Last Name" data-val="true"
                                            data-val-required="This field is required"
                                            data-val-regex="Please enter valid name. Only alphabets are allowed"
                                            data-val-regex-pattern="^[A-Z a-z]{1,35}$" onchange="updateProgress()">
                                        <span class="" data-valmsg-for="lastName" data-valmsg-replace="true"></span>
                                    </div>
                                    <div class="form-group">
                                        <label class="FormLabel">ID Number<span style="color:red;">*</span></label>

                                        <input type="text" name="idNumber" class="FormInput" id="idNumber"
                                            placeholder="Enter ID Number" data-val="true"
                                            data-val-required="This field is required"
                                            data-val-regex-pattern="^[A-Z a-z]{1,35}$" onchange="updateProgress()">
                                        <span data-valmsg-for="idNumber" data-valmsg-replace="true" class=""></span>
                                    </div>
                                    <div class="form-group">
                                        <label class="FormLabel">Name on Identify<span
                                                style="color:red;">*</span></label>
                                        <input type="text" id="idHolder" name="idHolder" class="FormInput inputRef"
                                            placeholder="Enter name on Identity" data-val="true"
                                            data-val-required="This field is required"
                                            data-val-regex="Please enter valid name. Only alphabets are allowed"
                                            data-val-regex-pattern="^[A-Z a-z]{1,35}$" onchange="updateProgress()">
                                        <span class="" data-valmsg-for="idHolder" data-valmsg-replace="true"></span>
                                    </div>

                                    <div class="form-group">
                                        <label class="FormLabel">Expiry Date<span style="color:red;">*</span></label>


                                        <input type="date" name="expiryDate" class="FormInput" id="expiryDate"
                                            placeholder="Enter ID Expiry Date" data-val="true"
                                            data-val-required="This field is required" onchange="updateProgress()">
                                        <span data-valmsg-for="expiryDate" data-valmsg-replace="true"
                                            id="ExpiryDate_error" class=""></span>

                                    </div>


                                </div>
                            </div>
                        </div>

                    </form>
                </fieldset>
            </div>
        </div>
    </div>



</section>


<script src="./Scripts/jquery.min.js"></script>
<!--Validation JS-->
<script src="./Scripts/validations/jquery.validate.min.js"></script>
<script src="./Scripts/validations/jquery.validate.unobtrusive.min.js"></script>
<script src="./Scripts/validations/additional-methods.min.js"></script>
<!--Keyboard JS-->
<script src="./Scripts/keyboard/jquery.keyboard.js"></script>
<script src="./Scripts/keyboard/jquery.keyboard.extension-previewkeyset.js"></script>
<script src="./Scripts/bootstrap-3.4.1-dist/js/bootstrap.min.js"></script>
<script src="./Scripts/datepicker/bootstrap-datepicker.min.js"></script>

<!--Steps JS-->
<script src="./Scripts/steps/jquery.steps.min.js"></script>
<script src="./js/FlatePicker.js"></script>

<!-- ---------- DatePicker --------- -->
<!-- <script src="./js/moment.js"></script>
<script src="./js/bootstrap-material-datetimepicker.js"></script>
<script src="./js/form-pickers-init.js"></script> -->

<script>




    $(document).ready(() => {


        (async () => {
            await showPreloaderAndLoadData();
        })();
        InitializeSteps(0);


        InitializeLibraries();
        Sets();



        flatpickr(".flatpickr", {
            enableTime: false,
            dateFormat: "Y-m-d",
            maxDate: new Date(),
            defaultDate: null,
            placeholder: "Select Date"
        });


        var modal = document.querySelector(".modalExit");
        var trigger = document.querySelector(".trigger");
        var closeButton = document.querySelector(".Cancel");

        function toggleModal() {
            debugger
            modal.classList.toggle("Showmodal");
        }

        function windowOnClick(event) {
            if (event.target === modal) {
                toggleModal();
            }
        }

        trigger.addEventListener("click", toggleModal);
        closeButton.addEventListener("click", toggleModal);
        window.addEventListener("click", windowOnClick);


    });
    function showPreloaderAndLoadData() {


        // Show the preloader
        $('#preloader12').show();


        setTimeout(function () {
            $('#preloader12').hide();
        }, 3000); // 3000 milliseconds = 3 seconds
    }

    function updateIssuingAuthority() {
        debugger;
        var idType = document.getElementById('idType').value;
        var issuingAuthority = document.getElementById('issuingAuthority');
        var issuingAuthorityText = document.getElementById('issuingAuthorityText');

        // Reset dropdown and hide the text input initially
        issuingAuthority.innerHTML = '<option value="" selected disabled>Select Issuing Authority</option>';

        issuingAuthorityText.classList.add('hidden'); // Add hidden class to the text input
        issuingAuthority.classList.remove('hidden'); // Remove hidden class from the dropdown

        // Set the dropdown options or show the free text field based on ID Type
        switch (idType) {
            case 'NATIONAL.ID':
                issuingAuthority.innerHTML += '<option value="NRB" selected>NRB</option>';
                break;
            case 'DRIVING.LICENSE':
            case 'ROAD.TRAF.REG.CARD':
                issuingAuthority.innerHTML += '<option value="DRTSS" selected>DRTSS</option>';
                break;
            case 'PASSPORT':
                issuingAuthority.innerHTML += '<option value="DPT OF IMMIGRATION" selected>DPT OF IMMIGRATION</option>';
                break;
            case 'STUDENT.ID':
                issuingAuthorityText.classList.remove('hidden'); // Show text input by removing the hidden class
                issuingAuthority.classList.add('hidden'); // Hide dropdown by adding the hidden class
                issuingAuthorityText.value = '';  // Clear previous value
                break;
            default:
                issuingAuthority.innerHTML += '<option value="" selected disabled>Select Issuing Authority</option>';
                break;
        }
    }
    function updateProgress() {


        var totalFields = 9; // Total number of fields to check
        var filledFields = 0;

        var accountType = document.getElementById('category').value;
        var firstName = document.getElementById('firstName').value;
        var middleName = document.getElementById('middleName').value;
        var lastName = document.getElementById('lastName').value;
        var idType = document.getElementById('idType').value;
        var idHolder = document.getElementById('idHolder').value;
        var issuingAuthorityText = document.getElementById('issuingAuthorityText').value;
        var idNumber = document.getElementById('idNumber').value;
        var issueDate = document.getElementById('issueDate').value;
        var expiryDate = document.getElementById('expiryDate').value;

        // Check if fields are filled and update filledFields count
        if (accountType.trim() !== '') filledFields++;
        if (middleName.trim() !== '') filledFields++;
        if (idType.trim() !== '') filledFields++;
        if (issuingAuthorityText.trim() !== '') filledFields++;
        if (firstName.trim() !== '') filledFields++;
        if (lastName.trim() !== '') filledFields++;
        if (idHolder.trim() !== '') filledFields++;
        if (idNumber.trim() !== '') filledFields++;
        if (issueDate.trim() !== '') filledFields++;
        if (expiryDate.trim() !== '') filledFields++;

        // Calculate the progress
        var progressPercentage = (filledFields / totalFields) * 100;
        var roundedPercentage = Math.round(progressPercentage);

        // Update the progress bar and text
        document.getElementById('percentageText').innerText = roundedPercentage;
        var progressElement = document.getElementById('Inputprogress');
        progressElement.style.width = progressPercentage + '%';
        progressElement.style.transition = 'width 1s ease-in-out';

        
    }


    InitializeSteps = (tabIndex) => {

        var form = $("#main-container");
        form.steps({
            headerTag: "h3",
            bodyTag: "fieldset",
            transitionEffect: "fade",
            startIndex: tabIndex,
            titleTemplate: '<div class="title" style="position: relative;top: 8px;right: 40px;" ><span class="title-text">#title#</span><span class="title-number">0#index#</span></div>',
            labels: {
                previous: 'Previous',
                next: 'Next',
                finish: 'Next',
                current: ''
            },
            onFinished: function (event, currentIndex) {
                NextForm(2);
            },
            onStepChanging: function (event, currentIndex, newIndex) {
                return ValidateForm(event, currentIndex, newIndex);
            }
        });

        $(".actions").prepend('<a href="javascript:void(0);" class="btn-save-exit trigger" >Exit</a>');
        $(".actions").prepend('<a href="javascript:void(0);" class="DefaultButton" style="display:none;" id="End_Exit">Exit</a>');
        // /*$(".actions").prepend('<a href="javascript:void(0);" class="btn-previous-activity DefaultButton" id="End_Previous" style="">Previous</a>');*/
        $(".actions").prepend('<a href="javascript:void(0);" class="btn-next-activity DefaultButton" id="End_Next" style="display:none;">Next</a>');

    }


    InitializeLibraries = () => {
        $('input[type="text"]').keyboard({ layout: 'international' }).previewKeyset({
            sets: ['normal', 'shift'/*, 'alt', 'alt-shift'*/]
        });

        $.each($('.numpad'), function (index, object) {
            $(object).keyboard().getkeyboard().destroy();
        });
        $('.numpad').keyboard({ layout: 'num' }).previewKeyset({
            sets: ['normal']
        });
        $.each($('.flatpickr'), function (index, object) {
            $(object).keyboard().getkeyboard().destroy();
        });

        $("#form-section").show();
        //$("head").append("<style>.loader-main:before { background: -webkit-radial-gradient(rgba(255, 255, 255, .8), rgba(100, 100, 100, .9)); } </style>");
    }

    Sets = () => {
        for (let form of document.querySelectorAll("form")) {
            $.validator.unobtrusive.parse(form);
        }
    }

    ChangeValue = (value) => {
        if (value == 1) {
            $("#ExitType").val("Exit");
        }
        else {
            $("#ExitType").val("Next");
        }
    }

    CheckDate = () => {
        var issueDate = document.getElementById('issueDate');
        var expiryDate = document.getElementById('expiryDate');
        var issueDateerror = document.getElementById('issueDate_error');
         var expiryDateerror= document.getElementById('ExpiryDate_error');
        if (issueDate && expiryDate) {
            var issueDate = new Date(issueDate.value);
            var expiryDate = new Date(expiryDate.value);
            if (issueDate > expiryDate) {
                expiryDateerror.classList.remove("field-validation-valid"); 
                expiryDateerror.classList.add("FormValidation"); 
                expiryDateerror.classList.add("field-validation-error"); // Add classes separately
                expiryDateerror.textContent = "Expiry Date Must be greater than Issue Date ";
                issueDate.focus(); // Highlight the field
                 
                return false; 
            } else {
                expiryDateerror.textContent = ""; 
                expiryDateerror.classList.remove("FormValidation"); 
                expiryDateerror.classList.remove("field-validation-error"); // Add classes separately
            }
        }
    }

    ValidateForm = (event, currentIndex, newIndex) => {

        var form = "#form-" + currentIndex;
        return $(form).valid();
    }

    NextForm = (type) => {

        
        if(CheckDate()){

            if (type == 1) {

                document.getElementsByClassName('modalExit')[0].style.display = 'none';

                
                ChangeValue(1);
                document.getElementById("End_Exit").click();
                return true;
            }

            $("#form-0").valid();

            if ($("#form-0").valid()) {
                ChangeValue(2);
                document.getElementById("End_Next").click();
            }
        }
    }
</script>